<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>维新工坊 - 与时间做朋友</title><meta name="author" content="Wang Wei"><meta name="copyright" content="Wang Wei"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="维新工坊">
<meta property="og:url" content="https://wangwei.one/page/4/index.html">
<meta property="og:site_name" content="维新工坊">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://wangwei.one/images/avatar.png">
<meta property="article:author" content="Wang Wei">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wangwei.one/images/avatar.png"><link rel="shortcut icon" href="/images/favicon-180x180.png"><link rel="canonical" href="https://wangwei.one/page/4/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//s4.cnzz.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-112239883-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-112239883-1');
</script><script async="async" data-pjax="data-pjax" src="https://s4.cnzz.com/z_stat.php?id=1270083794&amp;web_id=1270083794"></script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '维新工坊',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-03-11 14:31:04'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/lib/css/particles-style.min.css"><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">74</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">39</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-th"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-user"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/images/banner/index.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">维新工坊</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-th"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">维新工坊</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/wangweiX" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:dzd5ZWFyc0BnbWFpbC5jb20NCg==" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/posts/blockchain-eos-connect-public-network.html" title="连接 EOS 公共测试网络"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="连接 EOS 公共测试网络"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/blockchain-eos-connect-public-network.html" title="连接 EOS 公共测试网络">连接 EOS 公共测试网络</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2018-01-22T14:24:00.000Z" title="Created 2018-01-22 22:24:00">2018-01-22</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/blockchain/">blockchain</a></span></div><div class="content">




本文介绍如何将自己的本地测试网络连接到 EOS 公共测试网络 (Public Testnet) 上。
官方文档：https://github.com/EOSIO/eos/wiki/Testnet%3A%20Public



准备本地已经能够正常运行起了 EOS 的测试网络。如有问题，可参考这篇文档：运行 EOS 源代码（一）
公共测试网络端点 (Public Testnet Endpoints)现在可以通过以下几种方式去访问 EOS Public Testnet Endpoints

HTTP Endpoint: testnet1.eos.io
P2P Endpoint: p2p-testnet1.eos.io:9876
Web Wallet Endpoint: t1wallet.eos.io, t1api.eos.io, t1readonly.eos.io

通过浏览器或者终端命令行 crul 访问 testnet1.eos.io/v1/chain/get_info, 获得测试链信息
1$ curl testnet1.eos.io/v1/chain/get_info


 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/blockchain-eos-glossary.html" title="EOS 学习 (2) | EOS Glossary"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="EOS 学习 (2) | EOS Glossary"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/blockchain-eos-glossary.html" title="EOS 学习 (2) | EOS Glossary">EOS 学习 (2) | EOS Glossary</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2018-01-19T10:18:10.000Z" title="Created 2018-01-19 18:18:10">2018-01-19</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/blockchain/">blockchain</a></span></div><div class="content">




本文介绍和 EOS 相关的一些术语
官方文档：https://github.com/eosio/eos/wiki/Glossary



Account (账户)定义An on-chain identifier made up of native and/or custom permissions that are assigned one or more keys or accounts.

由本地和 / 或自定义权限组成的链上标识符，可以分配一个或多个密钥或者帐户。

Authority (权力)定义An abstract of permissions that represent how permissions are organized in reality that are bound to an individual or groups of individuals.

代表现实世界中一个个体或者一群个体的权限组织方式的抽象定义。

Block (区块)同义词
Blk

定义A confirmable unit of the Blockchain. Each bl ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/blockchain-token-summit-2017.html" title="全球区块链顶级会议 Token Summit 2017 一手信息解读"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="全球区块链顶级会议 Token Summit 2017 一手信息解读"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/blockchain-token-summit-2017.html" title="全球区块链顶级会议 Token Summit 2017 一手信息解读">全球区块链顶级会议 Token Summit 2017 一手信息解读</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-12-16T08:14:25.000Z" title="Created 2017-12-16 16:14:25">2017-12-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/blockchain/">blockchain</a></span></div><div class="content">
以下内容均来自 xdite 老师的直播分享

Token Summit 介绍Token Summit
全球区块链的顶级会议，是区块链行业里最具公信力的会议



会议主题
Token Summit I：Explored in-depth the Token-Based Economy.

第一次会议主要深度探讨以代币为基础的数字经济。


Token Summit II：Discuss the economics, regulation and practices around blockchain-based tokens, protocols, and crypto-assets. Focus on Designing Token-Based Economies, a key theme for this conference.

第二次会议讨论基于区块链的代币，协议和加密资产的经济，法规和实践。重点关注设计令牌经济。



主要的参与者
企业家、投资者、金融专业人士、律师、基金经理、监管者或商业主管等

价值
发掘潜在的创新思想，新的商业模式以及尚未被实施的商业点子

创始人
 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/learning-c-plus.html" title="c++ 学习笔记"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="c++ 学习笔记"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/learning-c-plus.html" title="c++ 学习笔记">c++ 学习笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-12-02T14:38:39.000Z" title="Created 2017-12-02 22:38:39">2017-12-02</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/coding/">coding</a></span></div><div class="content">今年对区块链技术产生了浓厚的兴趣，学习 c++ 编程主要的目的在于想去研究下 bitcoin、eos 等区块链的源代码，弄懂他们的运行机制及原理。


学习教程
GitHub: https://github.com/wangweiX/c-learning

基础
Step01 - Initialization project
Step02 - Variables, initialization, and assignment
Step03 - Creating a Basic Calculator
Step04 - If / else Statement
Step05 - Function
Step06 - Object-oriented programming(OOP)
Step07 - Placing Classes in Separate Files
Step08 - While、for、do while Loops
Step09 - Assignment and Increment Operators
Step10 - Making a Stock Market Simulat ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/blockchain-eos-build.html" title="EOS 学习 (1) | 安装部署"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="EOS 学习 (1) | 安装部署"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/blockchain-eos-build.html" title="EOS 学习 (1) | 安装部署">EOS 学习 (1) | 安装部署</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-09-12T09:38:00.000Z" title="Created 2017-09-12 17:38:00">2017-09-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/blockchain/">blockchain</a></span></div><div class="content">



本篇文章教你如何本地安装 EOS。


EOSIO 版本
Beginning build version: 1.2
2018 年 4 月 9 日 星期一 06 时 13 分 18 秒 UTC
git head id: 124c62d0e1b3974bcd551b885518ff05301b39c9
Current branch: * master
ARCHITECTURE: Darwin

系统环境
OS name: Darwin
OS Version: 10.13.4

执行构建脚本123$ git clone https://github.com/eosio/eos --recursive$ cd eos$ ./eosio_build.sh

出现如下信息，表示构建成功：

验证1$ /usr/local/bin/mongod -f /usr/local/etc/mongod.conf &amp; cd /Users/wangwei/eos/build; make test

测试结果：
1234567891011121314151617181920212223242526 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/netty-new-connection-and-niosocketchannel-analyse.html" title="Netty 新连接接入与 NioSocketChannel 分析"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Netty 新连接接入与 NioSocketChannel 分析"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/netty-new-connection-and-niosocketchannel-analyse.html" title="Netty 新连接接入与 NioSocketChannel 分析">Netty 新连接接入与 NioSocketChannel 分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-05-23T02:15:00.000Z" title="Created 2017-05-23 10:15:00">2017-05-23</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/coding/">coding</a></span></div><div class="content">



前面的一些章节，我们分析了 Netty 的三大组件 —— Channel 、EventLoop、Pipeline ，对 Netty 的工作原理有了深入的了解。在此基础上，我们来分析一下当 Netty 服务端启动后，Netty 是如何处理新连接接入的。



Netty 版本：4.1.30

本文内容主要分为以下四部分：

新连接检测
 NioSocketChannel 创建
 NioSocketChannel 初始化与注册
 NioSocketChannel 注册 READ 兴趣集

新连接检测前面，我们在讲 EventLoop 的启动过程源码分析 时，解读过下面这段代码：
1234567891011121314151617181920212223242526public final class NioEventLoop extends SingleThreadEventLoop {        ...            private void processSelectedKey(SelectionKey k, AbstractNioChannel ch) {     ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/netty-pipeline-source-analyse-2.html" title="Netty Pipeline 源码分析 (2)"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Netty Pipeline 源码分析 (2)"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/netty-pipeline-source-analyse-2.html" title="Netty Pipeline 源码分析 (2)">Netty Pipeline 源码分析 (2)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-05-19T09:13:00.000Z" title="Created 2017-05-19 17:13:00">2017-05-19</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/coding/">coding</a></span></div><div class="content">



前面 ，我们分析了 Netty Pipeline 的初始化及节点添加与删除逻辑。接下来，我们将来分析 Pipeline 的事件传播机制。



Netty 版本：4.1.30

inBound 事件传播示例我们通过下面这个例子来演示 Netty Pipeline 的事件传播机制。
1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465public class NettyPipelineInboundExample {    public static void main(String[] args) {        EventLoopGroup group = new NioEventLoopGroup(1);        ServerBootstrap strap = new ServerBootstrap();        strap.group(group)             ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/netty-pipeline-source-analyse-1.html" title="Netty Pipeline 源码分析 (1)"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Netty Pipeline 源码分析 (1)"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/netty-pipeline-source-analyse-1.html" title="Netty Pipeline 源码分析 (1)">Netty Pipeline 源码分析 (1)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-05-14T06:32:00.000Z" title="Created 2017-05-14 14:32:00">2017-05-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/coding/">coding</a></span></div><div class="content">



前面，我们分析了 Netty EventLoop 的 创建 与 启动 原理，接下里我们来分析 Netty 中另外两个重要组件 —— ChannelHandler 与 **Pipeline**。Netty 中 I/O 事件的传播机制均由它负责，下面我们来看看它是如何实现的。



Netty 版本：4.1.30

我们前面在讲 Channel 创建 时，在 AbstractChannel 的构造函数中， 一笔带过地提到了 Pipeline，现在我们来深入分析一下它的原理。
概述Netty channel lifecycle前面，我们在分析 Netty channel 源码时，分析了 Channel 的创建、初始化、注册、绑定过程。在 Netty 中，channel 的生命周期如下所示：


ChannelRegistered：Channel 注册到了 EventLoop 上
 ChannelActive：Channel 激活，连接到了远程某一个节点上，可以收发数据了
 ChannelInactive：断开连接
 ChannelUnregistered：Channel 从 Even ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/posts/netty-nioeventloop-analyse-for-startup.html" title="Netty NioEventLoop 启动过程源码分析"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Netty NioEventLoop 启动过程源码分析"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/netty-nioeventloop-analyse-for-startup.html" title="Netty NioEventLoop 启动过程源码分析">Netty NioEventLoop 启动过程源码分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-05-07T09:51:00.000Z" title="Created 2017-05-07 17:51:00">2017-05-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/coding/">coding</a></span></div><div class="content">



前面 ，我们分析了 NioEventLoop 的创建过程，接下来我们开始分析 NioEventLoop 的启动和执行逻辑。



Netty 版本：4.1.30

启动在之前分析 Channel 绑定 的文章中，提到过下面这段代码，先前只讲了 channel.bind () 绑定逻辑，跳过了 execute () 接口，现在我们以这个为例，开始分析 NioEventLoop 的 execute () 接口，主要逻辑如下：

添加任务队列
绑定当前线程到 EventLoop 上
调用 EventLoop 的 run () 方法 

1234567891011121314151617private static void doBind0(        final ChannelFuture regFuture, final Channel channel,        final SocketAddress localAddress, final ChannelPromise promise) {    // 通过eventLoop来执行channel绑定的Task    ch ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/posts/netty-nioeventloop-analyse-for-create.html" title="Netty NioEventLoop 创建过程源码分析"><img class="post_bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Netty NioEventLoop 创建过程源码分析"></a></div><div class="recent-post-info"><a class="article-title" href="/posts/netty-nioeventloop-analyse-for-create.html" title="Netty NioEventLoop 创建过程源码分析">Netty NioEventLoop 创建过程源码分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2017-04-30T00:24:00.000Z" title="Created 2017-04-30 08:24:00">2017-04-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/coding/">coding</a></span></div><div class="content">



前面 ，我们分析了 Netty 中的 Channel 组件，本篇我们来介绍一下与 Channel 关联的另一个核心的组件 —— EventLoop。



Netty 版本：4.1.30

概述EventLoop 定义了 Netty 的核心抽象，用于处理网络连接生命周期中所有发生的事件。
我们先来从一个比较高的视角来了解一下 Channels、Thread、EventLoops、EventLoopGroups 之间的关系。

上图是表示了拥有 4 个 EventLoop 的 EventLoopGroup 处理 IO 的流程图。它们之间的关系如下：

一个 EventLoopGroup 包含一个或多个 EventLoop
 一个 EventLoop 在它的生命周期内只和一个 Thread 绑定
所有由 EventLoop 处理的 I/O 事件都将在它专有的 Thread 上被处理
一个 Channel 在它的生命周期内只注册于一个 EventLoop
 一个 EventLoop 可能会被分配给一个或多个 Channel

EventLoop 原理下图是 Netty EventLo ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/3/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/#content-inner">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/#content-inner">8</a><a class="extend next" rel="next" href="/page/5/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Wang Wei</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">74</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">39</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/wangweiX" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:dzd5ZWFyc0BnbWFpbC5jb20NCg==" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/spring-cloud-eureka-source-code-analysis.html" title="SpringCloud 之 Eureka 源码分析"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SpringCloud 之 Eureka 源码分析"/></a><div class="content"><a class="title" href="/posts/spring-cloud-eureka-source-code-analysis.html" title="SpringCloud 之 Eureka 源码分析">SpringCloud 之 Eureka 源码分析</a><time datetime="2021-03-31T16:00:00.000Z" title="Created 2021-04-01 00:00:00">2021-04-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/jvm-gc-garbage-first.html" title="Garbage-First(G1)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Garbage-First(G1)"/></a><div class="content"><a class="title" href="/posts/jvm-gc-garbage-first.html" title="Garbage-First(G1)">Garbage-First(G1)</a><time datetime="2020-01-01T10:19:03.000Z" title="Created 2020-01-01 18:19:03">2020-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/netflix-guide.html" title="输入「神秘代码」解锁「隐藏类目」"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="输入「神秘代码」解锁「隐藏类目」"/></a><div class="content"><a class="title" href="/posts/netflix-guide.html" title="输入「神秘代码」解锁「隐藏类目」">输入「神秘代码」解锁「隐藏类目」</a><time datetime="2019-04-17T00:12:00.000Z" title="Created 2019-04-17 08:12:00">2019-04-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/How-to-change-icloud-region.html" title="数据移民漂流记 —— 如何进行 iCloud 转区操作"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据移民漂流记 —— 如何进行 iCloud 转区操作"/></a><div class="content"><a class="title" href="/posts/How-to-change-icloud-region.html" title="数据移民漂流记 —— 如何进行 iCloud 转区操作">数据移民漂流记 —— 如何进行 iCloud 转区操作</a><time datetime="2019-04-13T13:48:43.000Z" title="Created 2019-04-13 21:48:43">2019-04-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/How-to-register-and-use-the-Google-Voice.html" title="数据移民漂流记 —— 如何拥有属于自己的美国电话号码"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据移民漂流记 —— 如何拥有属于自己的美国电话号码"/></a><div class="content"><a class="title" href="/posts/How-to-register-and-use-the-Google-Voice.html" title="数据移民漂流记 —— 如何拥有属于自己的美国电话号码">数据移民漂流记 —— 如何拥有属于自己的美国电话号码</a><time datetime="2019-04-12T13:48:43.000Z" title="Created 2019-04-12 21:48:43">2019-04-12</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/blockchain/"><span class="card-category-list-name">blockchain</span><span class="card-category-list-count">13</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/coding/"><span class="card-category-list-name">coding</span><span class="card-category-list-count">47</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/tools/"><span class="card-category-list-name">tools</span><span class="card-category-list-count">13</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/writing/"><span class="card-category-list-name">writing</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/AlgoDS/" style="font-size: 1.46em; color: #99a7bb">AlgoDS</a> <a href="/tags/Design-Patterns/" style="font-size: 1.19em; color: #999da1">Design Patterns</a> <a href="/tags/DevOps/" style="font-size: 1.1em; color: #999">DevOps</a> <a href="/tags/Docker/" style="font-size: 1.14em; color: #999b9d">Docker</a> <a href="/tags/Elliptic-Curve/" style="font-size: 1.1em; color: #999">Elliptic Curve</a> <a href="/tags/Eureka/" style="font-size: 1.1em; color: #999">Eureka</a> <a href="/tags/GC/" style="font-size: 1.28em; color: #99a0aa">GC</a> <a href="/tags/IO/" style="font-size: 1.14em; color: #999b9d">IO</a> <a href="/tags/JVM/" style="font-size: 1.32em; color: #99a2ae">JVM</a> <a href="/tags/Java11/" style="font-size: 1.1em; color: #999">Java11</a> <a href="/tags/Java8/" style="font-size: 1.14em; color: #999b9d">Java8</a> <a href="/tags/JavaScript/" style="font-size: 1.1em; color: #999">JavaScript</a> <a href="/tags/Kindle/" style="font-size: 1.1em; color: #999">Kindle</a> <a href="/tags/LRU/" style="font-size: 1.1em; color: #999">LRU</a> <a href="/tags/LeetCode/" style="font-size: 1.32em; color: #99a2ae">LeetCode</a> <a href="/tags/Linux/" style="font-size: 1.1em; color: #999">Linux</a> <a href="/tags/Mac/" style="font-size: 1.1em; color: #999">Mac</a> <a href="/tags/Merkle-Tree/" style="font-size: 1.1em; color: #999">Merkle Tree</a> <a href="/tags/NIO/" style="font-size: 1.41em; color: #99a5b7">NIO</a> <a href="/tags/Netflix/" style="font-size: 1.1em; color: #999">Netflix</a> <a href="/tags/Netty/" style="font-size: 1.37em; color: #99a4b2">Netty</a> <a href="/tags/NodeJs/" style="font-size: 1.1em; color: #999">NodeJs</a> <a href="/tags/RocksDB/" style="font-size: 1.1em; color: #999">RocksDB</a> <a href="/tags/SPV/" style="font-size: 1.1em; color: #999">SPV</a> <a href="/tags/SpringCloud/" style="font-size: 1.1em; color: #999">SpringCloud</a> <a href="/tags/Token/" style="font-size: 1.1em; color: #999">Token</a> <a href="/tags/Tool/" style="font-size: 1.1em; color: #999">Tool</a> <a href="/tags/UTXO/" style="font-size: 1.14em; color: #999b9d">UTXO</a> <a href="/tags/bitcoin/" style="font-size: 1.32em; color: #99a2ae">bitcoin</a> <a href="/tags/bitcoin-script/" style="font-size: 1.1em; color: #999">bitcoin-script</a> <a href="/tags/blockchain/" style="font-size: 1.5em; color: #99a9bf">blockchain</a> <a href="/tags/c/" style="font-size: 1.1em; color: #999">c++</a> <a href="/tags/eos/" style="font-size: 1.28em; color: #99a0aa">eos</a> <a href="/tags/freedom/" style="font-size: 1.23em; color: #999ea6">freedom</a> <a href="/tags/hexo/" style="font-size: 1.23em; color: #999ea6">hexo</a> <a href="/tags/pow/" style="font-size: 1.1em; color: #999">pow</a> <a href="/tags/smart-contract/" style="font-size: 1.1em; color: #999">smart contract</a> <a href="/tags/%E5%86%99%E4%BD%9C/" style="font-size: 1.1em; color: #999">写作</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 1.1em; color: #999">工具</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span><a class="card-more-btn" href="/archives/" title="More">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">April 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/01/"><span class="card-archive-list-date">January 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/04/"><span class="card-archive-list-date">April 2019</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/02/"><span class="card-archive-list-date">February 2019</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/01/"><span class="card-archive-list-date">January 2019</span><span class="card-archive-list-count">9</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2018/10/"><span class="card-archive-list-date">October 2018</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2018/09/"><span class="card-archive-list-date">September 2018</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2018/05/"><span class="card-archive-list-date">May 2018</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">74</div></div><div class="webinfo-item"><div class="item-name">Run time :</div><div class="item-count" id="runtimeshow" data-publishDate="2014-12-11T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">Total Count :</div><div class="item-count">152.1k</div></div><div class="webinfo-item"><div class="item-name">UV :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">PV :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">Last Push :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-03-11T06:31:00.878Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2014 - 2022 By Wang Wei</div><div class="footer_custom_text">Stay Hungry, Stay Foolish</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>function subtitleType () {
  getScript('https://sdk.jinrishici.com/v2/browser/jinrishici.js').then(() => {
    jinrishici.load(result =>{
      if (true) {
        const sub = []
        const content = result.data.content
        sub.unshift(content)
        window.typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = result.data.content
      }
    })
  })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div><div id="particles-js"></div><script src="/lib/js/particles.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'UA-112239883-1', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>